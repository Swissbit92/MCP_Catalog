version: 1
servers:
  rag:
    kind: stdio
    launch:
      cmd: docker
      args:
        - run
        - --rm
        - -i
        - --network=graph_rag_dev
        - -v ${PWD}:/workspace
        - -w /workspace
        # If your images are named differently, update these:
        - graphdb_desktop-rag
        - python
        - -m
        - src.mcp.rag_server
      env:
        PYTHONUNBUFFERED: "1"
        CHROMA_DIR: /workspace/.chroma
        CHROMA_COLLECTION: whitepapers
        RAG_OUTPUTS_DIR: /workspace/outputs/run_simple
        RAG_EXPAND_PER_ENTITY: "true"
        OLLAMA_BASE: http://ollama:11434
        OLLAMA_EMBED_MODEL: nomic-embed-text

  kg:
    kind: stdio
    launch:
      cmd: docker
      args:
        - run
        - --rm
        - -i
        - --network=graph_rag_dev
        - -v ${PWD}:/workspace
        - -w /workspace
        - graphdb_desktop-kg
        - python
        - -m
        - src.mcp.kg_server
      env:
        PYTHONUNBUFFERED: "1"
        GRAPHDB_URL: http://graphdb:7200
        GRAPHDB_REPOSITORY: mcp_kg
        GRAPHDB_USERNAME: admin
        KG_ENTITY_ONLY: "true"
        KG_LABELS_DIR: /workspace/outputs/run_simple/labels
        KG_DOCS_DIR: /workspace/outputs/run_simple/docs
